System.register(["./Definitions"],function(e,t){"use strict";var a,d;t&&t.id;return{setters:[function(e){a=e}],execute:function(){d=function(){function e(e){var t=this;this._bindings={cardPileID:"",abanCardPileID:"",finishStackClass:"",coveredStackClass:"",cardClass:"",solveID:"",redealID:"",recallID:""},this._dropCardCallback=function(e,a,d){if(a||d||(a=e,d=e.parentNode,t._eventType="dblclick",d.lastChild===a?t._draggedType="card":t._draggedType="cardArray"),"cardArray"==t._draggedType){if("dblclick"==t._eventType)return;for(var r=0;r<d.children.length;r++)d.children[r]===a&&(t._draggedCardIndex=r)}else t._draggedCardIndex=d.children.length-1;if(t._draggedOrigClass=d.id.slice(0,-2),t._draggedOrigIndex="abandoned-card-pile"===d.id?0:parseInt(d.id.charAt(d.id.length-1)),"drag"==t._eventType&&(t._droppedDestClass=e.id.slice(0,-2),t._droppedDestIndex=parseInt(e.id.charAt(e.id.length-1)),e.classList.remove("high-light")),t._moveCardData()){switch(t._draggedType){case"cardArray":for(var n=document.createElement("div"),r=d.children.length-1;r>=t._draggedCardIndex;r--)n.appendChild(d.children[r]);for(;n.children.length;)e.appendChild(n.lastChild);break;case"card":"dblclick"===t._eventType?document.getElementsByClassName(t._droppedDestClass)[t._droppedDestIndex].appendChild(a):e.appendChild(a)}d.classList.contains("covered-stack")&&d.children.length&&t._uncoverTopCard(d)}t._endGameJudgement()},this._moveCardData=function(){var e,a;switch(t._draggedOrigClass){case"finish-stack":e=t.finishStacks[t._draggedOrigIndex];break;case"covered-stack":e=t.coveredStacks[t._draggedOrigIndex];break;case"abandoned-card-pi":e=t.abanCardPile;break;default:try{throw"Origin received unexpected class name."}catch(e){console.log(e)}return!1}if("dblclick"===t._eventType)if(0===e[e.length-1].card){for(var d=0;d<t.finishStacks.length;d++)if(!t.finishStacks[d].length){t._droppedDestClass="finish-stack",t._droppedDestIndex=d;break}}else{for(var d=0;d<t.finishStacks.length;d++)if(t.finishStacks[d].length&&t.finishStacks[d][t.finishStacks[d].length-1].suit===e[e.length-1].suit&&t.finishStacks[d][t.finishStacks[d].length-1].card===e[e.length-1].card-1){t._droppedDestClass="finish-stack",t._droppedDestIndex=d;break}if(!t._droppedDestClass)return!1}switch(t._droppedDestClass){case"finish-stack":if(a=t.finishStacks[t._droppedDestIndex],a===e)return!1;if("cardArray"==t._draggedType)return!1;if(a.length){if(e[e.length-1].suit!==a[0].suit)return alert("Suits of cards in this slot must be all the same!"),!1;if(e[e.length-1].card!==a[a.length-1].card+1)return alert("Card dropped on top of this slot must be 1 point larger than card below it!"),!1}else if(e[e.length-1].card)return alert("First card of this slot must be an Ace!"),!1;break;case"covered-stack":if(a=t.coveredStacks[t._droppedDestIndex],a===e)return!1;if("cardArray"==t._draggedType){if(a.length){if(1!==Math.abs(e[t._draggedCardIndex].suit%2-a[a.length-1].suit%2))return!1;if(e[t._draggedCardIndex].card!==a[a.length-1].card-1)return!1}else if(12!==e[t._draggedCardIndex].card)return!1}else if(a.length){if(1!==Math.abs(e[e.length-1].suit%2-a[a.length-1].suit%2))return alert("Card dropped on top of this slot must be different color of card below it!"),!1;if(e[e.length-1].card!==a[a.length-1].card-1)return alert("Card dropped on top of this slot must be 1 point less than card below it!"),!1}else if(12!==e[e.length-1].card)return alert("First card of this slot must be a King!"),!1;break;case"abandoned-card-pi":return!1;default:try{throw"Destiny received unexpected class name."}catch(e){console.log(e)}return!1}switch(t._draggedType){case"cardArray":for(var r=Array(0),d=e.length-1;d>=t._draggedCardIndex;d--)r.push(e.pop());for(;r.length;)a.push(r.pop());a=a.concat(e.slice(t._draggedCardIndex,e.length));break;case"card":a.push(e.pop());break;default:try{throw"Unexpected draggedType value."}catch(e){console.log(e)}return!1}return!0},this._endGameJudgement=function(){if(function(){for(var e=0;e<t.finishStacks.length;e++)if(13!==t.finishStacks[e].length)return!1;return!0}()){for(var e=0;e<document.getElementsByClassName("poker-card").length;e++)document.getElementsByClassName("poker-card")[e].draggable=!1;alert("Congratulations! You have won the game!")}},this.cardPile=a.createDeck(),this.abanCardPile=new Array(0),this.coveredStacks=a.createCoveredStacks(7),this.finishStacks=a.createFinishStacks(),this._bindings=e,this.dealCards(),this.onClickCardPile(),this.dragCard(),this.dbClickCard(),this.hint(),this.solve(),this.redeal(),this.recall()}return e.prototype._uncoverTopCard=function(e){e.lastChild.lastChild.classList.contains("hide")&&(e.lastChild.lastChild.classList.remove("hide"),this._toggleDraggable(e.lastChild))},e.prototype._toggleDraggable=function(e){e.draggable?e.draggable=!1:e.draggable=!0},e.prototype.dealCards=function(){for(var e=document.getElementById(this._bindings.cardPileID),t=document.getElementsByClassName(this._bindings.coveredStackClass),a=0;a<this.coveredStacks.length;a++)for(var d=0;d<this.coveredStacks[a].length;d++)this.coveredStacks[a][d]=this.cardPile.pop();for(var a=0;a<this.cardPile.length;a++)e.appendChild(this.cardPile[a].cardElement);for(var a=0;a<this.coveredStacks.length;a++){for(var d=0;d<this.coveredStacks[a].length;d++)t[a].appendChild(this.coveredStacks[a][d].cardElement);this._uncoverTopCard(t[a])}},e.prototype.onClickCardPile=function(){var e=this,t=document.getElementById(this._bindings.cardPileID),a=document.getElementById(this._bindings.abanCardPileID);t.addEventListener("mouseup",function(){if(this.children.length)this.lastChild.lastChild.classList.remove("hide"),e._toggleDraggable(this.lastChild),a.appendChild(this.lastChild),e.abanCardPile.push(e.cardPile.pop());else for(;a.children.length;)this.appendChild(a.lastChild),e._toggleDraggable(this.lastChild),this.lastChild.lastChild.classList.add("hide"),e.cardPile.push(e.abanCardPile.pop())})},e.prototype.dragCard=function(){var e,t,a=this,d=document.getElementsByClassName(this._bindings.cardClass),r=document.getElementsByClassName(this._bindings.finishStackClass),n=document.getElementsByClassName(this._bindings.coveredStackClass);document.addEventListener("dragover",function(e){e.preventDefault()}),document.addEventListener("drop",function(e){e.preventDefault()});for(var i=0;i<d.length;i++)d[i].addEventListener("dragstart",function(d){d.dataTransfer.setData("text/plain","zero"),e=this,t=this.parentNode,a._eventType="drag",t.lastChild===e?a._draggedType="card":a._draggedType="cardArray"}),d[i].addEventListener("dragend",function(){});for(var i=0;i<this.finishStacks.length;i++)r[i].addEventListener("dragenter",function(){this.classList.add("high-light")}),r[i].addEventListener("dragleave",function(e){e.stopPropagation(),this===e.target&&this.classList.remove("high-light")},!0),r[i].addEventListener("drop",function(){a._dropCardCallback(this,e,t)});for(var i=0;i<this.coveredStacks.length;i++)n[i].addEventListener("drop",function(){a._dropCardCallback(this,e,t)})},e.prototype.dbClickCard=function(){function e(){d._dropCardCallback(this.lastChild,t,a)}var t,a,d=this,r=document.getElementById(this._bindings.abanCardPileID),n=document.getElementsByClassName(this._bindings.coveredStackClass);r.addEventListener("dblclick",e);for(var i=0;i<n.length;i++)n[i].addEventListener("dblclick",e)},e.prototype.hint=function(){document.addEventListener("keydown",function(e){72===e.keyCode})},e.prototype.solve=function(){document.getElementById(this._bindings.solveID).addEventListener("click",function(){})},e.prototype.redeal=function(){document.getElementById(this._bindings.redealID).addEventListener("click",function(){})},e.prototype.recall=function(){function e(){}document.getElementById(this._bindings.recallID).addEventListener("click",function(){e()}),document.addEventListener("keydown",function(t){90===t.keyCode&&t.ctrlKey&&e()})},e}(),e("Klondike",d)}}});
//# sourceMappingURL=main.js.map
